{
    "sourceFile": "php/chart.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 15,
            "patches": [
                {
                    "date": 1767863135699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1767863143812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,53 +0,0 @@\n-async function loadDashboard() {\r\n-    try {\r\n-        const res = await fetch(\"php/admin-dashboard.php\");\r\n-        const data = await res.json();\r\n-\r\n-        if (!data.success) return console.error(\"Failed to fetch dashboard data\");\r\n-\r\n-        // ----------------- Update Stats -----------------\r\n-        document.getElementById(\"total-sales\").textContent = `₱${data.totalSales.toLocaleString()}`;\r\n-        document.getElementById(\"total-users\").textContent = data.totalUsers;\r\n-        document.getElementById(\"total-products\").textContent = data.totalProducts;\r\n-        document.getElementById(\"total-solds\").textContent = data.totalSolds;\r\n-\r\n-        // ----------------- Chart.js -----------------\r\n-        const ctx = document.getElementById('salesChart').getContext('2d');\r\n-\r\n-        new Chart(ctx, {\r\n-            type: 'bar',\r\n-            data: {\r\n-                labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\r\n-                datasets: [\r\n-                    {\r\n-                        label: 'Total Sales (₱)',\r\n-                        data: data.salesByMonth,\r\n-                        backgroundColor: 'rgba(54, 162, 235, 0.7)',\r\n-                        borderColor: 'rgba(54, 162, 235, 1)',\r\n-                        borderWidth: 1\r\n-                    },\r\n-                    {\r\n-                        label: 'Sold Items',\r\n-                        data: data.soldsByMonth,\r\n-                        backgroundColor: 'rgba(255, 99, 132, 0.7)',\r\n-                        borderColor: 'rgba(255, 99, 132, 1)',\r\n-                        borderWidth: 1\r\n-                    }\r\n-                ]\r\n-            },\r\n-            options: {\r\n-                responsive: true,\r\n-                plugins: {\r\n-                    legend: { position: 'top' },\r\n-                    title: { display: true, text: 'Monthly Sales & Sold Items' }\r\n-                },\r\n-                scales: { y: { beginAtZero: true } }\r\n-            }\r\n-        });\r\n-\r\n-    } catch (err) {\r\n-        console.error(\"Error loading dashboard:\", err);\r\n-    }\r\n-}\r\n-\r\n-document.addEventListener(\"DOMContentLoaded\", loadDashboard);\n\\ No newline at end of file\n"
                },
                {
                    "date": 1767863159631,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,53 @@\n+<?php\r\n+header(\"Content-Type: application/json\");\r\n+error_reporting(E_ALL);\r\n+ini_set(\"display_errors\", 1);\r\n+\r\n+$conn = new mysqli(\"localhost\", \"root\", \"\", \"ecommerce\");\r\n+if ($conn->connect_error) {\r\n+    echo json_encode([\"success\" => false, \"message\" => \"DB connection failed\"]);\r\n+    exit;\r\n+}\r\n+\r\n+// ----------------- USERS -----------------\r\n+$userRes = $conn->query(\"SELECT COUNT(*) AS totalUsers FROM users\");\r\n+$totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n+\r\n+// ----------------- PRODUCTS -----------------\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n+$totalProducts = 0;\r\n+$totalSolds = 0;\r\n+$totalSales = 0;\r\n+\r\n+// For monthly chart\r\n+$salesByMonth = array_fill(1, 12, 0);\r\n+$soldsByMonth = array_fill(1, 12, 0);\r\n+\r\n+while ($row = $prodRes->fetch_assoc()) {\r\n+    $totalProducts++;\r\n+    $sold = (int)$row['Sold'];\r\n+    $price = (float)$row['Price'];\r\n+    $totalSolds += $sold;\r\n+    $totalSales += ($sold * $price);\r\n+\r\n+    $month = (int)date('n', strtotime($row['AddingDate'])); // 1-12\r\n+    $salesByMonth[$month] += ($sold * $price);\r\n+    $soldsByMonth[$month] += $sold;\r\n+}\r\n+\r\n+// Convert monthly arrays to 0-based index arrays\r\n+$salesByMonth = array_values($salesByMonth);\r\n+$soldsByMonth = array_values($soldsByMonth);\r\n+\r\n+echo json_encode([\r\n+    \"success\" => true,\r\n+    \"totalUsers\" => $totalUsers,\r\n+    \"totalProducts\" => $totalProducts,\r\n+    \"totalSolds\" => $totalSolds,\r\n+    \"totalSales\" => $totalSales,\r\n+    \"salesByMonth\" => $salesByMonth,\r\n+    \"soldsByMonth\" => $soldsByMonth\r\n+]);\r\n+\r\n+$conn->close();\r\n+?>\r\n"
                },
                {
                    "date": 1767863393075,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n <?php\r\n+error_reporting(E_ALL);\r\n+ini_set('display_errors', 1);\r\n header(\"Content-Type: application/json\");\r\n-error_reporting(E_ALL);\r\n-ini_set(\"display_errors\", 1);\r\n \r\n $conn = new mysqli(\"localhost\", \"root\", \"\", \"ecommerce\");\r\n if ($conn->connect_error) {\r\n     echo json_encode([\"success\" => false, \"message\" => \"DB connection failed\"]);\r\n"
                },
                {
                    "date": 1767863443793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,6 +48,11 @@\n     \"salesByMonth\" => $salesByMonth,\r\n     \"soldsByMonth\" => $soldsByMonth\r\n ]);\r\n \r\n+if ($conn->connect_error) {\r\n+    die(\"Connection failed: \" . $conn->connect_error);\r\n+}\r\n+\r\n+\r\n $conn->close();\r\n ?>\r\n"
                },
                {
                    "date": 1767863457280,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,11 +48,7 @@\n     \"salesByMonth\" => $salesByMonth,\r\n     \"soldsByMonth\" => $soldsByMonth\r\n ]);\r\n \r\n-if ($conn->connect_error) {\r\n-    die(\"Connection failed: \" . $conn->connect_error);\r\n-}\r\n \r\n-\r\n $conn->close();\r\n ?>\r\n"
                },
                {
                    "date": 1767863598886,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,26 +1,31 @@\n <?php\r\n-error_reporting(E_ALL);\r\n-ini_set('display_errors', 1);\r\n header(\"Content-Type: application/json\");\r\n \r\n $conn = new mysqli(\"localhost\", \"root\", \"\", \"ecommerce\");\r\n if ($conn->connect_error) {\r\n     echo json_encode([\"success\" => false, \"message\" => \"DB connection failed\"]);\r\n     exit;\r\n }\r\n \r\n+// Disable HTML errors from breaking JSON\r\n+set_error_handler(function($errno, $errstr, $errfile, $errline) {\r\n+    echo json_encode([\"success\" => false, \"message\" => \"PHP error: $errstr\"]);\r\n+    exit;\r\n+});\r\n+\r\n // ----------------- USERS -----------------\r\n $userRes = $conn->query(\"SELECT COUNT(*) AS totalUsers FROM users\");\r\n+if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n $prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n+if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n+\r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n $totalSales = 0;\r\n-\r\n-// For monthly chart\r\n $salesByMonth = array_fill(1, 12, 0);\r\n $soldsByMonth = array_fill(1, 12, 0);\r\n \r\n while ($row = $prodRes->fetch_assoc()) {\r\n@@ -29,14 +34,13 @@\n     $price = (float)$row['Price'];\r\n     $totalSolds += $sold;\r\n     $totalSales += ($sold * $price);\r\n \r\n-    $month = (int)date('n', strtotime($row['AddingDate'])); // 1-12\r\n+    $month = (int)date('n', strtotime($row['AddingDate']));\r\n     $salesByMonth[$month] += ($sold * $price);\r\n     $soldsByMonth[$month] += $sold;\r\n }\r\n \r\n-// Convert monthly arrays to 0-based index arrays\r\n $salesByMonth = array_values($salesByMonth);\r\n $soldsByMonth = array_values($soldsByMonth);\r\n \r\n echo json_encode([\r\n@@ -48,7 +52,6 @@\n     \"salesByMonth\" => $salesByMonth,\r\n     \"soldsByMonth\" => $soldsByMonth\r\n ]);\r\n \r\n-\r\n $conn->close();\r\n ?>\r\n"
                },
                {
                    "date": 1767863661483,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,57 +1,85 @@\n-<?php\r\n-header(\"Content-Type: application/json\");\r\n+async function loadDashboard() {\r\n+    try {\r\n+        console.log(\"Fetching dashboard data...\");\r\n \r\n-$conn = new mysqli(\"localhost\", \"root\", \"\", \"ecommerce\");\r\n-if ($conn->connect_error) {\r\n-    echo json_encode([\"success\" => false, \"message\" => \"DB connection failed\"]);\r\n-    exit;\r\n-}\r\n+        const res = await fetch(\"../php/chart.php\");\r\n \r\n-// Disable HTML errors from breaking JSON\r\n-set_error_handler(function($errno, $errstr, $errfile, $errline) {\r\n-    echo json_encode([\"success\" => false, \"message\" => \"PHP error: $errstr\"]);\r\n-    exit;\r\n-});\r\n+        console.log(\"Fetch response status:\", res.status, res.statusText);\r\n \r\n-// ----------------- USERS -----------------\r\n-$userRes = $conn->query(\"SELECT COUNT(*) AS totalUsers FROM users\");\r\n-if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n-$totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n+        // Read raw text first\r\n+        const text = await res.text();\r\n+        console.log(\"Raw response from PHP:\", text);\r\n \r\n-// ----------------- PRODUCTS -----------------\r\n-$prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n-if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n+        // Try to parse JSON\r\n+        let data;\r\n+        try {\r\n+            data = JSON.parse(text);\r\n+        } catch (jsonErr) {\r\n+            console.error(\"Failed to parse JSON:\", jsonErr);\r\n+            return;\r\n+        }\r\n \r\n-$totalProducts = 0;\r\n-$totalSolds = 0;\r\n-$totalSales = 0;\r\n-$salesByMonth = array_fill(1, 12, 0);\r\n-$soldsByMonth = array_fill(1, 12, 0);\r\n+        console.log(\"Parsed JSON data:\", data);\r\n \r\n-while ($row = $prodRes->fetch_assoc()) {\r\n-    $totalProducts++;\r\n-    $sold = (int)$row['Sold'];\r\n-    $price = (float)$row['Price'];\r\n-    $totalSolds += $sold;\r\n-    $totalSales += ($sold * $price);\r\n+        if (!data.success) {\r\n+            console.error(\"Dashboard error from PHP:\", data.message || \"Unknown error\");\r\n+            return;\r\n+        }\r\n \r\n-    $month = (int)date('n', strtotime($row['AddingDate']));\r\n-    $salesByMonth[$month] += ($sold * $price);\r\n-    $soldsByMonth[$month] += $sold;\r\n-}\r\n+        // ----------------- Update Stats -----------------\r\n+        const totalSalesEl = document.getElementById(\"total-sales\");\r\n+        const totalUsersEl = document.getElementById(\"total-users\");\r\n+        const totalProductsEl = document.getElementById(\"total-products\");\r\n+        const totalSoldsEl = document.getElementById(\"total-solds\");\r\n+        const chartEl = document.getElementById('salesChart');\r\n \r\n-$salesByMonth = array_values($salesByMonth);\r\n-$soldsByMonth = array_values($soldsByMonth);\r\n+        if (!totalSalesEl || !totalUsersEl || !totalProductsEl || !totalSoldsEl || !chartEl) {\r\n+            console.error(\"One or more HTML elements are missing!\");\r\n+            return;\r\n+        }\r\n \r\n-echo json_encode([\r\n-    \"success\" => true,\r\n-    \"totalUsers\" => $totalUsers,\r\n-    \"totalProducts\" => $totalProducts,\r\n-    \"totalSolds\" => $totalSolds,\r\n-    \"totalSales\" => $totalSales,\r\n-    \"salesByMonth\" => $salesByMonth,\r\n-    \"soldsByMonth\" => $soldsByMonth\r\n-]);\r\n+        totalSalesEl.textContent = `₱${data.totalSales.toLocaleString()}`;\r\n+        totalUsersEl.textContent = data.totalUsers;\r\n+        totalProductsEl.textContent = data.totalProducts;\r\n+        totalSoldsEl.textContent = data.totalSolds;\r\n \r\n-$conn->close();\r\n-?>\r\n+        // ----------------- Chart.js -----------------\r\n+        const ctx = chartEl.getContext('2d');\r\n+\r\n+        new Chart(ctx, {\r\n+            type: 'bar',\r\n+            data: {\r\n+                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n+                datasets: [\r\n+                    {\r\n+                        label: 'Total Sales (₱)',\r\n+                        data: data.salesByMonth,\r\n+                        backgroundColor: 'rgba(54, 162, 235, 0.7)',\r\n+                        borderColor: 'rgba(54, 162, 235, 1)',\r\n+                        borderWidth: 1\r\n+                    },\r\n+                    {\r\n+                        label: 'Sold Items',\r\n+                        data: data.soldsByMonth,\r\n+                        backgroundColor: 'rgba(255, 99, 132, 0.7)',\r\n+                        borderColor: 'rgba(255, 99, 132, 1)',\r\n+                        borderWidth: 1\r\n+                    }\r\n+                ]\r\n+            },\r\n+            options: {\r\n+                responsive: true,\r\n+                plugins: {\r\n+                    legend: { position: 'top' },\r\n+                    title: { display: true, text: 'Monthly Sales & Sold Items' }\r\n+                },\r\n+                scales: { y: { beginAtZero: true } }\r\n+            }\r\n+        });\r\n+\r\n+    } catch (err) {\r\n+        console.error(\"Error loading dashboard:\", err);\r\n+    }\r\n+}\r\n+\r\n+document.addEventListener(\"DOMContentLoaded\", loadDashboard);\r\n"
                },
                {
                    "date": 1767863707982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,85 +1,57 @@\n-async function loadDashboard() {\r\n-    try {\r\n-        console.log(\"Fetching dashboard data...\");\r\n+<?php\r\n+header(\"Content-Type: application/json\");\r\n \r\n-        const res = await fetch(\"../php/chart.php\");\r\n+$conn = new mysqli(\"localhost\", \"root\", \"\", \"ecommerce\");\r\n+if ($conn->connect_error) {\r\n+    echo json_encode([\"success\" => false, \"message\" => \"DB connection failed\"]);\r\n+    exit;\r\n+}\r\n \r\n-        console.log(\"Fetch response status:\", res.status, res.statusText);\r\n+// Disable HTML errors from breaking JSON\r\n+set_error_handler(function($errno, $errstr, $errfile, $errline) {\r\n+    echo json_encode([\"success\" => false, \"message\" => \"PHP error: $errstr\"]);\r\n+    exit;\r\n+});\r\n \r\n-        // Read raw text first\r\n-        const text = await res.text();\r\n-        console.log(\"Raw response from PHP:\", text);\r\n+// ----------------- USERS -----------------\r\n+$userRes = $conn->query(\"SELECT COUNT(*) AS totalUsers FROM users\");\r\n+if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n+$totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n-        // Try to parse JSON\r\n-        let data;\r\n-        try {\r\n-            data = JSON.parse(text);\r\n-        } catch (jsonErr) {\r\n-            console.error(\"Failed to parse JSON:\", jsonErr);\r\n-            return;\r\n-        }\r\n+// ----------------- PRODUCTS -----------------\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n+if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n-        console.log(\"Parsed JSON data:\", data);\r\n+$totalProducts = 0;\r\n+$totalSolds = 0;\r\n+$totalSales = 0;\r\n+$salesByMonth = array_fill(1, 12, 0);\r\n+$soldsByMonth = array_fill(1, 12, 0);\r\n \r\n-        if (!data.success) {\r\n-            console.error(\"Dashboard error from PHP:\", data.message || \"Unknown error\");\r\n-            return;\r\n-        }\r\n+while ($row = $prodRes->fetch_assoc()) {\r\n+    $totalProducts++;\r\n+    $sold = (int)$row['Sold'];\r\n+    $price = (float)$row['Price'];\r\n+    $totalSolds += $sold;\r\n+    $totalSales += ($sold * $price);\r\n \r\n-        // ----------------- Update Stats -----------------\r\n-        const totalSalesEl = document.getElementById(\"total-sales\");\r\n-        const totalUsersEl = document.getElementById(\"total-users\");\r\n-        const totalProductsEl = document.getElementById(\"total-products\");\r\n-        const totalSoldsEl = document.getElementById(\"total-solds\");\r\n-        const chartEl = document.getElementById('salesChart');\r\n+    $month = (int)date('n', strtotime($row['AddingDate']));\r\n+    $salesByMonth[$month] += ($sold * $price);\r\n+    $soldsByMonth[$month] += $sold;\r\n+}\r\n \r\n-        if (!totalSalesEl || !totalUsersEl || !totalProductsEl || !totalSoldsEl || !chartEl) {\r\n-            console.error(\"One or more HTML elements are missing!\");\r\n-            return;\r\n-        }\r\n+$salesByMonth = array_values($salesByMonth);\r\n+$soldsByMonth = array_values($soldsByMonth);\r\n \r\n-        totalSalesEl.textContent = `₱${data.totalSales.toLocaleString()}`;\r\n-        totalUsersEl.textContent = data.totalUsers;\r\n-        totalProductsEl.textContent = data.totalProducts;\r\n-        totalSoldsEl.textContent = data.totalSolds;\r\n+echo json_encode([\r\n+    \"success\" => true,\r\n+    \"totalUsers\" => $totalUsers,\r\n+    \"totalProducts\" => $totalProducts,\r\n+    \"totalSolds\" => $totalSolds,\r\n+    \"totalSales\" => $totalSales,\r\n+    \"salesByMonth\" => $salesByMonth,\r\n+    \"soldsByMonth\" => $soldsByMonth\r\n+]);\r\n \r\n-        // ----------------- Chart.js -----------------\r\n-        const ctx = chartEl.getContext('2d');\r\n-\r\n-        new Chart(ctx, {\r\n-            type: 'bar',\r\n-            data: {\r\n-                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\r\n-                datasets: [\r\n-                    {\r\n-                        label: 'Total Sales (₱)',\r\n-                        data: data.salesByMonth,\r\n-                        backgroundColor: 'rgba(54, 162, 235, 0.7)',\r\n-                        borderColor: 'rgba(54, 162, 235, 1)',\r\n-                        borderWidth: 1\r\n-                    },\r\n-                    {\r\n-                        label: 'Sold Items',\r\n-                        data: data.soldsByMonth,\r\n-                        backgroundColor: 'rgba(255, 99, 132, 0.7)',\r\n-                        borderColor: 'rgba(255, 99, 132, 1)',\r\n-                        borderWidth: 1\r\n-                    }\r\n-                ]\r\n-            },\r\n-            options: {\r\n-                responsive: true,\r\n-                plugins: {\r\n-                    legend: { position: 'top' },\r\n-                    title: { display: true, text: 'Monthly Sales & Sold Items' }\r\n-                },\r\n-                scales: { y: { beginAtZero: true } }\r\n-            }\r\n-        });\r\n-\r\n-    } catch (err) {\r\n-        console.error(\"Error loading dashboard:\", err);\r\n-    }\r\n-}\r\n-\r\n-document.addEventListener(\"DOMContentLoaded\", loadDashboard);\r\n+$conn->close();\r\n+?>\r\n"
                },
                {
                    "date": 1767863717006,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n-$prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, Adding Date FROM products\");\r\n if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n"
                },
                {
                    "date": 1767863722483,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n-$prodRes = $conn->query(\"SELECT Sold, Price, Adding Date FROM products\");\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n"
                },
                {
                    "date": 1767863728094,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n-$prodRes = $conn->query(\"SELECT Sold, Price, AddingDate FROM products\");\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, [AddingDate] FROM products\");\r\n if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n"
                },
                {
                    "date": 1767863740381,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n-$prodRes = $conn->query(\"SELECT Sold, Price, [AddingDate] FROM products\");\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, [Adding Date] FROM products\");\r\n if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n@@ -34,9 +34,9 @@\n     $price = (float)$row['Price'];\r\n     $totalSolds += $sold;\r\n     $totalSales += ($sold * $price);\r\n \r\n-    $month = (int)date('n', strtotime($row['AddingDate']));\r\n+    $month = (int)date('n', strtotime($row['Adding Date']));\r\n     $salesByMonth[$month] += ($sold * $price);\r\n     $soldsByMonth[$month] += $sold;\r\n }\r\n \r\n"
                },
                {
                    "date": 1767863804055,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,8 +19,9 @@\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n $prodRes = $conn->query(\"SELECT Sold, Price, [Adding Date] FROM products\");\r\n+\r\n if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n"
                },
                {
                    "date": 1767863811973,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,10 +18,11 @@\n if (!$userRes) { echo json_encode([\"success\"=>false,\"message\"=>\"User query failed\"]); exit; }\r\n $totalUsers = ($userRes->num_rows > 0) ? $userRes->fetch_assoc()['totalUsers'] : 0;\r\n \r\n // ----------------- PRODUCTS -----------------\r\n-$prodRes = $conn->query(\"SELECT Sold, Price, [Adding Date] FROM products\");\r\n+$prodRes = $conn->query(\"SELECT Sold, Price, `Adding Date` FROM products\");\r\n \r\n+\r\n if (!$prodRes) { echo json_encode([\"success\"=>false,\"message\"=>\"Products query failed\"]); exit; }\r\n \r\n $totalProducts = 0;\r\n $totalSolds = 0;\r\n"
                },
                {
                    "date": 1767863825817,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,10 @@\n     $price = (float)$row['Price'];\r\n     $totalSolds += $sold;\r\n     $totalSales += ($sold * $price);\r\n \r\n-    $month = (int)date('n', strtotime($row['Adding Date']));\r\n+ $month = (int)date('n', strtotime($row['Adding Date']));\r\n+\r\n     $salesByMonth[$month] += ($sold * $price);\r\n     $soldsByMonth[$month] += $sold;\r\n }\r\n \r\n"
                }
            ],
            "date": 1767863135699,
            "name": "Commit-0",
            "content": "async function loadDashboard() {\r\n    try {\r\n        const res = await fetch(\"php/admin-dashboard.php\");\r\n        const data = await res.json();\r\n\r\n        if (!data.success) return console.error(\"Failed to fetch dashboard data\");\r\n\r\n        // ----------------- Update Stats -----------------\r\n        document.getElementById(\"total-sales\").textContent = `₱${data.totalSales.toLocaleString()}`;\r\n        document.getElementById(\"total-users\").textContent = data.totalUsers;\r\n        document.getElementById(\"total-products\").textContent = data.totalProducts;\r\n        document.getElementById(\"total-solds\").textContent = data.totalSolds;\r\n\r\n        // ----------------- Chart.js -----------------\r\n        const ctx = document.getElementById('salesChart').getContext('2d');\r\n\r\n        new Chart(ctx, {\r\n            type: 'bar',\r\n            data: {\r\n                labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\r\n                datasets: [\r\n                    {\r\n                        label: 'Total Sales (₱)',\r\n                        data: data.salesByMonth,\r\n                        backgroundColor: 'rgba(54, 162, 235, 0.7)',\r\n                        borderColor: 'rgba(54, 162, 235, 1)',\r\n                        borderWidth: 1\r\n                    },\r\n                    {\r\n                        label: 'Sold Items',\r\n                        data: data.soldsByMonth,\r\n                        backgroundColor: 'rgba(255, 99, 132, 0.7)',\r\n                        borderColor: 'rgba(255, 99, 132, 1)',\r\n                        borderWidth: 1\r\n                    }\r\n                ]\r\n            },\r\n            options: {\r\n                responsive: true,\r\n                plugins: {\r\n                    legend: { position: 'top' },\r\n                    title: { display: true, text: 'Monthly Sales & Sold Items' }\r\n                },\r\n                scales: { y: { beginAtZero: true } }\r\n            }\r\n        });\r\n\r\n    } catch (err) {\r\n        console.error(\"Error loading dashboard:\", err);\r\n    }\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", loadDashboard);"
        }
    ]
}